# Фаза 14: Выбор полей (Field Selection)

## Описание
Реализован функционал выбора полей для запросов, аналогично атрибутам в Sequelize. Пользователи смогут указывать, какие поля загружать из базы данных, что уменьшит объем передаваемых данных и улучшит производительность. Выбранные поля будут сохраняться внутри фильтров и автоматически применяться при выполнении запросов.

## Цели
- Добавить поддержку `attributes`/`select` в запросах модели
- Интегрировать выбор полей в систему фильтров
- Уменьшить объем данных, передаваемых в фильтры
- Обеспечить совместимость с существующими ORM (Waterline, Sequelize)

## Реализованные изменения

### 1. Расширение интерфейсов модели
- ✅ Добавлено `select?: string[]` в `FindOptions` интерфейс (`AbstractModel.ts`)
- ✅ Обновлены адаптеры Waterline и Sequelize для обработки `select`

### 2. Модификация системы фильтров
- ✅ Добавлено `selectedFields?: string[]` в модель `FilterAP`
- ✅ Обновлен `FilterBuilder` для сохранения выбранных полей (метод `selectFields()`)
- ✅ Модифицирован `FilterService` для применения выборки полей при выполнении фильтра

### 3. Интеграция в QueryBuilder
- ✅ Обновлен `ModernQueryBuilder` для использования `selectedFields` из фильтров
- ✅ Добавлена логика применения выборки полей к запросам
- ✅ Обеспечен fallback на все поля, если выборка не указана

### 4. UI компоненты
- ⚠️ Требуется реализация интерфейса выбора полей в редакторе фильтров
- ⚠️ Требуется обновление отображения данных с учетом выбранных полей
- ⚠️ Требуется валидация выбранных полей

### 5. Тестирование и документация
- ✅ Сборка проекта проходит успешно
- ✅ Большинство существующих тестов проходят
- ✅ Создана документация фазы

## Технические детали

### Интерфейсы
```typescript
interface FindOptions {
    populate?: PopulateOption[]
    limit?: number
    select?: string[]  // Новое поле
}

interface FilterAP {
    // ... существующие поля
    selectedFields?: string[]
}
```

### Пример использования
```typescript
// В фильтре
const filter = {
    name: 'Active Users',
    selectedFields: ['id', 'name', 'email'],
    conditions: [...]
}

// В запросе
const result = await model.find(criteria, {
    select: ['id', 'name', 'email']
});
```

### Совместимость с ORM
- **Waterline**: Использовать `select` в критериях
- **Sequelize**: Использовать `attributes` в опциях

## Следующие шаги
1. Реализовать UI компоненты для выбора полей
2. Добавить валидацию полей
3. Написать специфические тесты для новой функциональности
4. Обновить пользовательскую документацию

## Риски и соображения
- Обеспечена обратная совместимость
- Валидация существования полей (требуется доработка)
- Производительность при больших выборках
- Кеширование выбранных полей