# –§–∞–∑–∞ 10: Dashboard Widget - —Å—á—ë—Ç—á–∏–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: P2
## –°—Ç–∞—Ç—É—Å: ‚è≥ –ù–µ –Ω–∞—á–∞—Ç–∞
## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –§–∞–∑–∞ 1, 3, –°–∏—Å—Ç–µ–º–∞ –≤–∏–¥–∂–µ—Ç–æ–≤

> **üí° –ü–°–ï–í–î–û–ö–û–î:** –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –≤–∏–¥–∂–µ—Ç–æ–≤ –∏ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ ‚Äî **–ü–°–ï–í–î–û–ö–û–î –≤ —Å—Ç–∏–ª–µ JavaScript**. –ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥ —Å–∏—Å—Ç–µ–º—É –≤–∏–¥–∂–µ—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞.

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–∞ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ö–æ–¥–∞:
- –°—á—ë—Ç—á–∏–∫ —Å —á–∏—Å–ª–æ–º –∑–∞–ø–∏—Å–µ–π
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–∏–æ–¥–æ–º (—Ç—Ä–µ–Ω–¥)
- –ö–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è –∏ —Ü–≤–µ—Ç–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

---

## üéØ –¶–µ–ª–∏

1. ‚úÖ –í–∏–¥–∂–µ—Ç —Å—á—ë—Ç—á–∏–∫–∞ (extends AbstractInfo)
2. ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
3. ‚úÖ –ü–æ–∫–∞–∑ —Ç—Ä–µ–Ω–¥–æ–≤ (—Ä–æ—Å—Ç/–ø–∞–¥–µ–Ω–∏–µ)
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
5. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
6. ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤ –æ–¥–Ω–æ–º –≤–∏–¥–∂–µ—Ç–µ

---

## ‚úÖ –ó–∞–¥–∞—á–∏

- [ ] 10.1 FilterCountWidget
- [ ] 10.2 FilterTrendWidget
- [ ] 10.3 FilterMultiCountWidget
- [ ] 10.4 –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- [ ] 10.5 React frontend components
- [ ] 10.6 Unit —Ç–µ—Å—Ç—ã (75%+ coverage)
  - [ ] 10.6.1 FilterCountWidget.getData()
  - [ ] 10.6.2 FilterTrendWidget.calculateTrend()
  - [ ] 10.6.3 Cache hit/miss logic
  - [ ] 10.6.4 Color indicator mapping
  - [ ] 10.6.5 Multiple filter aggregation
- [ ] 10.7 Integration —Ç–µ—Å—Ç—ã
  - [ ] 10.7.1 Widget registration in dashboard
  - [ ] 10.7.2 Real-time updates via WebSocket
  - [ ] 10.7.3 Cache invalidation on data change
  - [ ] 10.7.4 Navigation to filter results
- [ ] 10.8 Performance —Ç–µ—Å—Ç—ã
  - [ ] 10.8.1 Widget render < 100ms
  - [ ] 10.8.2 Cached query < 10ms
  - [ ] 10.8.3 Trend calculation < 50ms
- [ ] 10.9 E2E —Ç–µ—Å—Ç—ã
  - [ ] 10.9.1 Add widget to dashboard
  - [ ] 10.9.2 View count updates
  - [ ] 10.9.3 Click to navigate to results
  - [ ] 10.9.4 Configure colors and thresholds

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
  lib/
    widgets/
      FilterCountWidget.ts          # –í–∏–¥–∂–µ—Ç —Å—á—ë—Ç—á–∏–∫–∞
      FilterTrendWidget.ts          # –í–∏–¥–∂–µ—Ç —Å —Ç—Ä–µ–Ω–¥–∞–º–∏
      FilterMultiCountWidget.ts     # –ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤
      
  assets/
    ui/
      widgets/
        FilterCountWidget.tsx       # Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
        FilterTrendChart.tsx        # –ì—Ä–∞—Ñ–∏–∫ —Ç—Ä–µ–Ω–¥–∞
        
  system/
    bindFilterWidgets.ts            # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–∏–¥–∂–µ—Ç–æ–≤
```

---

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. Filter Count Widget (Backend)

**–§–∞–π–ª:** `src/lib/widgets/FilterCountWidget.ts`

```typescript
import { abstractInfo } from './abstractInfo';
import { DataAccessor } from '../DataAccessor';

interface FilterCountWidgetConfig {
  filterId: string;              // UUID —Ñ–∏–ª—å—Ç—Ä–∞ (—Å—Ç—Ä–æ–∫–∞!)
  label?: string;
  icon?: string;
  showTrend?: boolean;
  trendPeriod?: 'day' | 'week' | 'month';
  colorThresholds?: {
    green?: number;
    yellow?: number;
    red?: number;
  };
  refreshInterval?: number; // –í —Å–µ–∫—É–Ω–¥–∞—Ö
}

export class FilterCountWidget extends abstractInfo {
  private dataAccessor: DataAccessor;
  
  constructor(dataAccessor: DataAccessor) {
    super();
    this.dataAccessor = dataAccessor;
  }
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–∏–¥–∂–µ—Ç–∞
   */
  async getData(req: any, config: FilterCountWidgetConfig) {
    const filter = await this.dataAccessor.findOne('FilterAP', {
      id: config.filterId
    });
    
    if (!filter) {
      return {
        error: 'Filter not found'
      };
    }
    
    // –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
    const count = await this.dataAccessor.count(
      filter.modelName,
      filter.criteria
    );
    
    // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–≤–µ—Ç –ø–æ –ø–æ—Ä–æ–≥–∞–º
    const color = this.getColorByThreshold(count, config.colorThresholds);
    
    let trend = null;
    if (config.showTrend) {
      trend = await this.calculateTrend(filter, count, config.trendPeriod);
    }
    
    return {
      label: config.label || filter.name,
      value: count,
      color,
      icon: config.icon || 'filter_alt',
      link: `/adminizer/filter/${filter.id}`,  // üîó –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∏–ª—å—Ç—Ä!
      trend,
      refreshInterval: config.refreshInterval || 60
    };
  }
  
  /**
   * –†–µ–Ω–¥–µ—Ä –≤–∏–¥–∂–µ—Ç–∞
   */
  async render(req: any, config: FilterCountWidgetConfig) {
    const data = await this.getData(req, config);
    
    return {
      type: 'filter-count',
      component: 'FilterCountWidget',
      props: data
    };
  }
  
  /**
   * –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–≤–µ—Ç –ø–æ –ø–æ—Ä–æ–≥–∞–º
   */
  private getColorByThreshold(
    count: number,
    thresholds?: {
      green?: number;
      yellow?: number;
      red?: number;
    }
  ): string {
    if (!thresholds) {
      return 'blue';
    }
    
    if (thresholds.red !== undefined && count >= thresholds.red) {
      return 'red';
    }
    if (thresholds.yellow !== undefined && count >= thresholds.yellow) {
      return 'yellow';
    }
    if (thresholds.green !== undefined && count >= thresholds.green) {
      return 'green';
    }
    
    return 'gray';
  }
  
  /**
   * –í—ã—á–∏—Å–ª–∏—Ç—å —Ç—Ä–µ–Ω–¥
   */
  private async calculateTrend(
    filter: any,
    currentCount: number,
    period: 'day' | 'week' | 'month' = 'day'
  ) {
    // –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–µ—Ä–∏–æ–¥
    const periodMs = this.getPeriodMs(period);
    const sinceDate = new Date(Date.now() - periodMs);
    
    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è —É—á—ë—Ç–∞ –¥–∞—Ç—ã
    const historicalCriteria = {
      ...filter.criteria,
      createdAt: { '<': sinceDate }
    };
    
    const previousCount = await this.dataAccessor.count(
      filter.modelName,
      historicalCriteria
    );
    
    const diff = currentCount - previousCount;
    const percentChange = previousCount > 0
      ? ((diff / previousCount) * 100).toFixed(1)
      : '0';
    
    return {
      diff,
      percentChange: parseFloat(percentChange),
      direction: diff > 0 ? 'up' : diff < 0 ? 'down' : 'same',
      period
    };
  }
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–∏–æ–¥–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
   */
  private getPeriodMs(period: 'day' | 'week' | 'month'): number {
    switch (period) {
      case 'day':
        return 24 * 60 * 60 * 1000;
      case 'week':
        return 7 * 24 * 60 * 60 * 1000;
      case 'month':
        return 30 * 24 * 60 * 60 * 1000;
    }
  }
}
```

---

### 2. Filter Trend Widget

**–§–∞–π–ª:** `src/lib/widgets/FilterTrendWidget.ts`

```typescript
import { abstractInfo } from './abstractInfo';
import { DataAccessor } from '../DataAccessor';

interface FilterTrendWidgetConfig {
  filterId: string;
  label?: string;
  period: 'day' | 'week' | 'month';
  dataPoints?: number; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ
}

export class FilterTrendWidget extends abstractInfo {
  private dataAccessor: DataAccessor;
  
  constructor(dataAccessor: DataAccessor) {
    super();
    this.dataAccessor = dataAccessor;
  }
  
  async getData(req: any, config: FilterTrendWidgetConfig) {
    const filter = await this.dataAccessor.findOne('FilterAP', {
      id: config.filterId
    });
    
    if (!filter) {
      return { error: 'Filter not found' };
    }
    
    const dataPoints = config.dataPoints || 7;
    const chartData = await this.getChartData(filter, config.period, dataPoints);
    
    return {
      label: config.label || filter.name,
      chartData,
      link: `/adminizer/filters/${filter.id}/results`,
      period: config.period
    };
  }
  
  async render(req: any, config: FilterTrendWidgetConfig) {
    const data = await this.getData(req, config);
    
    return {
      type: 'filter-trend',
      component: 'FilterTrendChart',
      props: data
    };
  }
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
   */
  private async getChartData(
    filter: any,
    period: 'day' | 'week' | 'month',
    points: number
  ) {
    const periodMs = this.getPeriodMs(period);
    const data: { date: string; count: number }[] = [];
    
    for (let i = points - 1; i >= 0; i--) {
      const endDate = new Date(Date.now() - i * periodMs);
      const startDate = new Date(endDate.getTime() - periodMs);
      
      const criteria = {
        ...filter.criteria,
        createdAt: {
          '>=': startDate,
          '<': endDate
        }
      };
      
      const count = await this.dataAccessor.count(
        filter.modelName,
        criteria
      );
      
      data.push({
        date: endDate.toISOString().split('T')[0],
        count
      });
    }
    
    return data;
  }
  
  private getPeriodMs(period: 'day' | 'week' | 'month'): number {
    switch (period) {
      case 'day':
        return 24 * 60 * 60 * 1000;
      case 'week':
        return 7 * 24 * 60 * 60 * 1000;
      case 'month':
        return 30 * 24 * 60 * 60 * 1000;
    }
  }
}
```

---

### 3. Multi-Filter Widget

**–§–∞–π–ª:** `src/lib/widgets/FilterMultiCountWidget.ts`

```typescript
import { abstractInfo } from './abstractInfo';
import { DataAccessor } from '../DataAccessor';

interface FilterMultiCountWidgetConfig {
  filters: Array<{
    filterId: string;
    label?: string;
    color?: string;
  }>;
  layout?: 'horizontal' | 'vertical' | 'grid';
  showTotals?: boolean;
}

export class FilterMultiCountWidget extends abstractInfo {
  private dataAccessor: DataAccessor;
  
  constructor(dataAccessor: DataAccessor) {
    super();
    this.dataAccessor = dataAccessor;
  }
  
  async getData(req: any, config: FilterMultiCountWidgetConfig) {
    const counts = await Promise.all(
      config.filters.map(async (filterConfig) => {
        const filter = await this.dataAccessor.findOne('FilterAP', {
          id: filterConfig.filterId
        });
        
        if (!filter) {
          return null;
        }
        
        const count = await this.dataAccessor.count(
          filter.modelName,
          filter.criteria
        );
        
        return {
          filterId: filter.id,
          label: filterConfig.label || filter.name,
          count,
          color: filterConfig.color || 'blue',
          link: `/adminizer/filters/${filter.id}/results`
        };
      })
    );
    
    const validCounts = counts.filter(c => c !== null);
    const total = config.showTotals
      ? validCounts.reduce((sum, c) => sum + (c?.count || 0), 0)
      : null;
    
    return {
      filters: validCounts,
      total,
      layout: config.layout || 'vertical'
    };
  }
  
  async render(req: any, config: FilterMultiCountWidgetConfig) {
    const data = await this.getData(req, config);
    
    return {
      type: 'filter-multi-count',
      component: 'FilterMultiCountWidget',
      props: data
    };
  }
}
```

---

## üé® Frontend Components

### Filter Count Widget

**–§–∞–π–ª:** `src/assets/ui/widgets/FilterCountWidget.tsx`

```tsx
import React from 'react';
import { TrendingUp, TrendingDown, Minus } from 'lucide-react';
import { Link } from '@inertiajs/react';

interface FilterCountWidgetProps {
  label: string;
  value: number;
  color: string;
  icon: string;
  link: string;
  trend?: {
    diff: number;
    percentChange: number;
    direction: 'up' | 'down' | 'same';
    period: string;
  };
  refreshInterval?: number;
}

export function FilterCountWidget({
  label,
  value,
  color,
  icon,
  link,
  trend,
  refreshInterval
}: FilterCountWidgetProps) {
  const [currentValue, setCurrentValue] = React.useState(value);
  
  React.useEffect(() => {
    if (!refreshInterval) return;
    
    const interval = setInterval(async () => {
      // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
      const response = await fetch(`${link}/count`);
      const data = await response.json();
      setCurrentValue(data.count);
    }, refreshInterval * 1000);
    
    return () => clearInterval(interval);
  }, [refreshInterval, link]);
  
  const colorClasses = {
    red: 'bg-red-50 text-red-600 border-red-200',
    yellow: 'bg-yellow-50 text-yellow-600 border-yellow-200',
    green: 'bg-green-50 text-green-600 border-green-200',
    blue: 'bg-blue-50 text-blue-600 border-blue-200',
    gray: 'bg-gray-50 text-gray-600 border-gray-200'
  };
  
  const trendIcon = trend?.direction === 'up'
    ? <TrendingUp size={16} />
    : trend?.direction === 'down'
    ? <TrendingDown size={16} />
    : <Minus size={16} />;
  
  const trendColor = trend?.direction === 'up'
    ? 'text-green-600'
    : trend?.direction === 'down'
    ? 'text-red-600'
    : 'text-gray-600';
  
  return (
    <Link href={link} className="filter-count-widget">
      <div className={`widget-card ${colorClasses[color] || colorClasses.blue}`}>
        <div className="widget-header">
          <span className="material-icons">{icon}</span>
          <span className="widget-label">{label}</span>
        </div>
        
        <div className="widget-value">
          {currentValue.toLocaleString()}
        </div>
        
        {trend && (
          <div className={`widget-trend ${trendColor}`}>
            {trendIcon}
            <span>{Math.abs(trend.percentChange)}%</span>
            <span className="trend-period">vs {trend.period}</span>
          </div>
        )}
      </div>
    </Link>
  );
}
```

---

### Filter Trend Chart

**–§–∞–π–ª:** `src/assets/ui/widgets/FilterTrendChart.tsx`

```tsx
import React from 'react';
import { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer } from 'recharts';
import { Link } from '@inertiajs/react';

interface FilterTrendChartProps {
  label: string;
  chartData: Array<{ date: string; count: number }>;
  link: string;
  period: string;
}

export function FilterTrendChart({
  label,
  chartData,
  link,
  period
}: FilterTrendChartProps) {
  return (
    <div className="filter-trend-widget">
      <div className="widget-header">
        <h3>{label}</h3>
        <Link href={link} className="view-link">
          View ‚Üí
        </Link>
      </div>
      
      <div className="chart-container">
        <ResponsiveContainer width="100%" height={200}>
          <LineChart data={chartData}>
            <XAxis
              dataKey="date"
              tickFormatter={(date) => new Date(date).toLocaleDateString()}
            />
            <YAxis />
            <Tooltip />
            <Line
              type="monotone"
              dataKey="count"
              stroke="#3b82f6"
              strokeWidth={2}
              dot={{ fill: '#3b82f6', r: 4 }}
            />
          </LineChart>
        </ResponsiveContainer>
      </div>
      
      <div className="widget-footer">
        Period: {period}
      </div>
    </div>
  );
}
```

---

### Multi-Count Widget

**–§–∞–π–ª:** `src/assets/ui/widgets/FilterMultiCountWidget.tsx`

```tsx
import React from 'react';
import { Link } from '@inertiajs/react';

interface FilterItem {
  filterId: string;
  label: string;
  count: number;
  color: string;
  link: string;
}

interface FilterMultiCountWidgetProps {
  filters: FilterItem[];
  total?: number;
  layout: 'horizontal' | 'vertical' | 'grid';
}

export function FilterMultiCountWidget({
  filters,
  total,
  layout
}: FilterMultiCountWidgetProps) {
  const layoutClasses = {
    horizontal: 'flex flex-row gap-4',
    vertical: 'flex flex-col gap-2',
    grid: 'grid grid-cols-2 gap-4'
  };
  
  return (
    <div className="filter-multi-count-widget">
      <div className={layoutClasses[layout]}>
        {filters.map((filter) => (
          <Link
            key={filter.filterId}
            href={filter.link}
            className="filter-item"
          >
            <div className={`count-badge bg-${filter.color}-100 text-${filter.color}-700`}>
              {filter.count}
            </div>
            <div className="filter-label">{filter.label}</div>
          </Link>
        ))}
      </div>
      
      {total !== null && (
        <div className="total-count">
          Total: {total}
        </div>
      )}
    </div>
  );
}
```

---

## üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–∏–¥–∂–µ—Ç–æ–≤

**–§–∞–π–ª:** `src/system/bindFilterWidgets.ts`

```typescript
import { FilterCountWidget } from '../lib/widgets/FilterCountWidget';
import { FilterTrendWidget } from '../lib/widgets/FilterTrendWidget';
import { FilterMultiCountWidget } from '../lib/widgets/FilterMultiCountWidget';

export default function bindFilterWidgets(adminizer: any) {
  const dataAccessor = adminizer.getDataAccessor();
  
  // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–∏–¥–∂–µ—Ç–æ–≤
  adminizer.registerWidget('filter-count', new FilterCountWidget(dataAccessor));
  adminizer.registerWidget('filter-trend', new FilterTrendWidget(dataAccessor));
  adminizer.registerWidget('filter-multi-count', new FilterMultiCountWidget(dataAccessor));
  
  console.log('Filter widgets registered');
}
```

---

## üé® –°—Ç–∏–ª–∏

```scss
// filter-widgets.scss
.filter-count-widget {
  text-decoration: none;
  display: block;
  
  .widget-card {
    padding: 1.5rem;
    border-radius: 12px;
    border: 2px solid;
    transition: all 0.2s;
    
    &:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
  }
  
  .widget-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
    
    .material-icons {
      font-size: 24px;
    }
    
    .widget-label {
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
  }
  
  .widget-value {
    font-size: 2.5rem;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 0.5rem;
  }
  
  .widget-trend {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    
    .trend-period {
      color: #6b7280;
      font-weight: 400;
    }
  }
}

.filter-trend-widget {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  
  .widget-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    
    h3 {
      font-size: 1rem;
      font-weight: 600;
      margin: 0;
    }
    
    .view-link {
      color: #3b82f6;
      text-decoration: none;
      font-size: 0.875rem;
      
      &:hover {
        text-decoration: underline;
      }
    }
  }
  
  .chart-container {
    margin: 1rem 0;
  }
  
  .widget-footer {
    font-size: 0.875rem;
    color: #6b7280;
    text-align: center;
  }
}

.filter-multi-count-widget {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  
  .filter-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: #f9fafb;
    border-radius: 8px;
    text-decoration: none;
    transition: all 0.2s;
    
    &:hover {
      background: #f3f4f6;
      transform: translateX(4px);
    }
    
    .count-badge {
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      font-size: 1.25rem;
      font-weight: 700;
    }
    
    .filter-label {
      flex: 1;
      font-size: 0.875rem;
      font-weight: 500;
      color: #374151;
    }
  }
  
  .total-count {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
    font-size: 1.25rem;
    font-weight: 600;
    text-align: center;
    color: #111827;
  }
}
```

---

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```typescript
// –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–∞—à–±–æ—Ä–¥–∞
export default {
  widgets: [
    {
      type: 'filter-count',
      config: {
        filterId: 'active-users-filter',
        label: 'Active Users',
        icon: 'people',
        showTrend: true,
        trendPeriod: 'week',
        colorThresholds: {
          green: 100,
          yellow: 50,
          red: 0
        },
        refreshInterval: 60
      },
      position: { x: 0, y: 0, w: 3, h: 2 }
    },
    {
      type: 'filter-trend',
      config: {
        filterId: 'new-orders-filter',
        label: 'New Orders',
        period: 'day',
        dataPoints: 14
      },
      position: { x: 3, y: 0, w: 6, h: 3 }
    },
    {
      type: 'filter-multi-count',
      config: {
        filters: [
          { filterId: 'pending-filter', label: 'Pending', color: 'yellow' },
          { filterId: 'approved-filter', label: 'Approved', color: 'green' },
          { filterId: 'rejected-filter', label: 'Rejected', color: 'red' }
        ],
        layout: 'horizontal',
        showTotals: true
      },
      position: { x: 9, y: 0, w: 3, h: 2 }
    }
  ]
};
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] FilterCountWidget backend
- [ ] FilterTrendWidget backend
- [ ] FilterMultiCountWidget backend
- [ ] Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤—Å–µ—Ö –≤–∏–¥–∂–µ—Ç–æ–≤
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- [ ] Auto-refresh —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- [ ] –¶–≤–µ—Ç–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
- [ ] –¢—Ä–µ–Ω–¥—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ –≤–∏–¥–∂–µ—Ç–æ–≤
- [ ] –¢–µ—Å—Ç—ã
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
2. ‚úÖ WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
3. ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –≤–∏–¥–∂–µ—Ç–æ–≤
